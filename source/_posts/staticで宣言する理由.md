title: staticで宣言する理由
date: 2015-01-11 23:46:51
tags: プログラミング
---

金曜日にコンピュータプログラミングのTAやってて，
メイン関数の中に「大きな配列を宣言するときには`static`を使うこと」
とかコメントで書いてあった．

C言語というかメモリ周りの話には全く弱くてわからなかったので先生に聞いてみた．
`static`なしで宣言した変数はスタック領域からメモリを確保する．
スタック領域は大きさが決まっているので（コンパイル時に指定することは可能）
大きすぎるとスタックオーバーフローするから，という話だった．
`static`をつけるとヒープ（スタック以外の領域）からメモリを確保するのでその問題はないと．
ほかグローバル変数のようなずっと残る変数や，`malloc`で確保した場合にもヒープから確保される．

たとえば，こんなコードを書くとスタックオーバーフローでセグフォして落ちる．

```C
#include <stdio.h>

int main()
{
    char a[8192 * 1024];
    printf("hoge\n");
}
```

スタックのサイズはシェルで`ulimit -s`ってやるとわかる．

勉強になった．
